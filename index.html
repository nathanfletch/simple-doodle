<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />

    <title>Doodle</title>
  </head>
  <body>
    <canvas id="doodle-canvas"></canvas>
    <script>
      const canvas = document.getElementById("doodle-canvas");
      const ctx = canvas.getContext("2d");
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;

      ctx.strokeStyle = "blue";
      ctx.lineJoin = "round";
      ctx.lineCap = "round";
      ctx.lineWidth = 2;

      let drawing = false;
      // let mode = "";
      //line:
      //width, numlines,
      //circle:

      let oldX = null;
      let oldY = null;
      let rotationOffset = 0;
      let rotationSpeed = 0.2;
      let hue = 0;
      let saturation = 80;
      let lightness = 50;
      let opacity = 100;
      let radius = 20;
      let radiusIncreasing = true;
      let numLines = 3;
      let oldXOffsets = [];
      let newYOffsets = [];

      function draw(e) {
        if (!drawing) return;
        //switch statement to check all our state?
        // simpleLine();
        // multiLine(5, 20);
        console.log(`hue: ${hue}`);
        console.log(`radius: ${radius}`);
        console.log(`numLines: ${numLines}`);
        ctx.strokeStyle = `hsla(${hue}, ${saturation}%, ${lightness}%, ${opacity}%)`;
        multiLineCircleRotate(5);

        [oldX, oldY] = [e.offsetX, e.offsetY];
        
        if (e.ctrlKey) {
          rotationOffset += rotationSpeed;
        }
        if (e.altKey) {
          hue = (hue + 1) % 360;
          // if (radius > 15 || radius < 5) {
          //   radiusIncreasing = !radiusIncreasing;
          // }
          // radiusIncreasing ? (radius += 0.5) : (radius -= 0.5);
        }

        

        function multiLine(numLines, gap) {
          ctx.beginPath();
          for (let i = 0; i < numLines; i++) {
            ctx.moveTo(oldX, oldY + gap * i);
            ctx.lineTo(e.offsetX, e.offsetY + gap * i);
          }
          ctx.stroke();
          [oldX, oldY] = [e.offsetX, e.offsetY];
        }

        function multiLineCircleRotate() {
          ctx.beginPath();
          for (let i = 0; i < numLines; i++) {
            //new offset calc
            const currentRadians =
            ((rotationOffset + 2) * Math.PI * (i + 1)) / numLines;
            xOffset = radius * Math.cos(currentRadians);
            yOffset = radius * Math.sin(currentRadians);

            if (e.ctrlKey) {
              oldRotationOffset = rotationOffset - rotationSpeed;
              const oldRadians =
                ((oldRotationOffset + 2) * Math.PI * (i + 1)) / numLines;
              oldXOffset = radius * Math.cos(oldRadians);
              oldYOffset = radius * Math.sin(oldRadians);
              ctx.moveTo(oldX + oldXOffset, oldY + oldYOffset);

            } else {
              ctx.moveTo(oldX + xOffset, oldY + yOffset);
            }

            ctx.lineTo(e.offsetX + xOffset, e.offsetY + yOffset); //offsetX is the new angle this move




            // ctx.moveTo(oldX + xOffset, oldY + yOffset);
            // ctx.lineTo(e.offsetX + xOffset, e.offsetY + yOffset);
          }
          ctx.stroke();
        }
      }

      // canvas.addEventListener("mousemove", draw);
      canvas.addEventListener("mousemove", draw);
      canvas.addEventListener("mousedown", (e) => {
        [oldX, oldY] = [e.offsetX, e.offsetY];
        drawing = true;
      });
      canvas.addEventListener("mouseup", () => {
        [oldX, oldY] = [null, null];
        drawing = false;
      });
      canvas.addEventListener("mouseout", () => {
        [oldX, oldY] = [null, null];
        drawing = false;
      });
      // document.addEventListener("keydown", (e) => {
      //   if(e.key > 0 && e.key < 10);
      //   numLines = e.key;
      // })
    </script>
  </body>
</html>
